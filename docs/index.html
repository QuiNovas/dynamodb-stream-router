

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Home &mdash; dynamodb-stream-router 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home"> dynamodb-stream-router
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Home</a></li>
<li><a class="reference internal" href="#dynamodb-stream-router">dynamodb_stream_router</a><ul>
<li><a class="reference internal" href="#router-streamrouter">router.StreamRouter</a></li>
<li><a class="reference internal" href="#router-route">router.Route</a></li>
<li><a class="reference internal" href="#router-exceptionhandler">router.ExceptionHandler</a></li>
<li><a class="reference internal" href="#router-streamrecord">router.StreamRecord</a></li>
<li><a class="reference internal" href="#router-result">router.Result</a></li>
</ul>
</li>
<li><a class="reference internal" href="#dynamodb-stream-router-conditions-module">dynamodb_stream_router.conditions module</a><ul>
<li><a class="reference internal" href="#conditions-parser-expression">conditions.parser.Expression</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">dynamodb-stream-router</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>Home</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="home">
<h1>Home<a class="headerlink" href="#home" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="dynamodb-stream-router">
<h1>dynamodb_stream_router<a class="headerlink" href="#dynamodb-stream-router" title="Permalink to this headline">¶</a></h1>
<div class="section" id="router-streamrouter">
<h2>router.StreamRouter<a class="headerlink" href="#router-streamrouter" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.router.StreamRouter">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.router.</span></code><code class="sig-name descname"><span class="pre">StreamRouter</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threaded</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">allow_multiple_matches</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception_handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.ExceptionHandler" title="dynamodb_stream_router.router.ExceptionHandler"><span class="pre">dynamodb_stream_router.router.ExceptionHandler</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halt_on_exception</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p id="dynamodb-stream-router-router-streamrouter">Provides routing of Dynamodb Stream records to Callables based on record eventName and an optional condition, expressed
as a string to be evaluated by <a class="reference internal" href="#dynamodb-stream-router-conditions-parser-expression-parse">dynamodb_stream_router.conditions.parser.Expression.parse</a> or a truthy function that receives
the record as its sole argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>threaded:</em> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): If True then each record will be processed in a separate thread using ThreadPoolExecutor</p></li>
<li><p><em>threads:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Max number of threads for ThreadPoolExecutor. Only applies if <em>threaded=True</em></p></li>
<li><p><em>allow_multiple_matches:</em> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): Optional flag indicating whether or not to allow multiple route matches
for a record. If True and multiple routes match a record then <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.exceptions.MultipleRouteMatches</span></code>
will be raised. Useful if continuing to process a record after an unintended route match could cause problems in your
application</p></li>
</ul>
</dd>
</dl>
<p>Intelligently decides what Callable to invoke for a given record based on the StreamRecord’s eventName and optional conditions in the form
of callables or a condition expression that is parsed by <a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> . Decorators are used to register callables
as Route(s).</p>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">Record</span><span class="p">,</span> <span class="n">StreamRouter</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">StreamRouter</span><span class="p">()</span>

<span class="n">records</span> <span class="o">=</span> <span class="p">[{</span>
    <span class="c1"># Only NEW_AND_OLD_IMAGES are supported</span>
        <span class="s2">&quot;StreamViewType&quot;</span><span class="p">:</span> <span class="s2">&quot;NEW_AND_OLD_IMAGES&quot;</span><span class="p">,</span>
        <span class="s2">&quot;eventName&quot;</span><span class="p">:</span> <span class="s2">&quot;MODIFY&quot;</span><span class="p">,</span>
        <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;OldImage&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                                    <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="p">[</span>
                                        <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;baz&quot;</span><span class="p">}</span>
                                    <span class="p">]</span>
                                <span class="p">}</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">},</span>
            <span class="s2">&quot;NewImage&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;sometype&quot;</span><span class="p">}</span>
            <span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}]</span>

<span class="nd">@router</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;type&#39;)&quot;</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">my_first_route</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">router</span><span class="o">.</span><span class="n">resolve_all</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example above the function * my_first_route() * will be called because * record.OldImage[“type”] * has changed in comparison to * record.NewImage[“type”].
This example uses <a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> as the condition_expression used to match the route to the record. In addition to passing
a string-based expression you could pass your own callable, for instance a lambda, that accepts * record * as its only required argument and returns a bool
indicating whether or not the route matches.</p>
<p>Example using a lambda as condition_expression:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">StreamRouter</span><span class="p">()</span>

<span class="nd">@router</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">OldImage</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="n">x</span><span class="o">.</span><span class="n">NewImage</span><span class="p">[</span><span class="s2">&quot;type&quot;</span><span class="p">])</span>
<span class="k">def</span> <span class="nf">my_first_route</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
        <span class="k">return</span> <span class="kc">True</span>

    <span class="n">res</span> <span class="o">=</span> <span class="n">router</span><span class="o">.</span><span class="n">resolve_all</span><span class="p">(</span><span class="n">records</span><span class="p">)</span>
</pre></div>
</div>
<p>The second example(assuming we used the same list of records) would have the same result as the first</p>
<dl class="py attribute">
<dt id="dynamodb_stream_router.router.StreamRouter.allow_multiple_matches">
<code class="sig-name descname"><span class="pre">allow_multiple_matches</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.allow_multiple_matches" title="Permalink to this definition">¶</a></dt>
<dd><p>Whether or not to allow multiple routes to be called on a single record. If False and multiple routes are found for a record an exception will be raised</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.StreamRouter.exception_handler">
<code class="sig-name descname"><span class="pre">exception_handler</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#dynamodb_stream_router.router.ExceptionHandler" title="dynamodb_stream_router.router.ExceptionHandler"><span class="pre">dynamodb_stream_router.router.ExceptionHandler</span></a></em><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.exception_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>If defined then a route handler that raises an exception defined in exception_handler will have its record, and the exception, passed to exception_handler.handler</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.StreamRouter.halt_on_exception">
<code class="sig-name descname"><span class="pre">halt_on_exception</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.halt_on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>If defined then a route handler that raises an exception will propagate that exception. Otherwise the exception will be placed in the result and execution will continue</p>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.insert">
<code class="sig-name descname"><span class="pre">insert</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.insert" title="Permalink to this definition">¶</a></dt>
<dd><p id="dynamodb-stream-router-router-streamrouter-insert">Wrapper for StreamRouter.route(). Creates a route for “INSERT” operation, taking an optional condition_expression</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>condition_expression:</em> (<code class="docutils literal notranslate"><span class="pre">Union[Callable,</span> <span class="pre">str]</span></code>): An expression that returns a boolean indicating if
the route should be called for a particular record. If type is <code class="docutils literal notranslate"><span class="pre">str</span></code> then the expression will be parsed using
<a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> <em>parse()</em> method to generate the callable</p></li>
<li><p><em>halt:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Stop processing of record after this route is called. The same effect can be acheived by returning
an object of type <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.Halt</span></code>. Default is False</p></li>
<li><p><em>priority:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The priority of this route in the list of any matching routes for a record. Default is 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;foo&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_foo</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.modify">
<code class="sig-name descname"><span class="pre">modify</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.modify" title="Permalink to this definition">¶</a></dt>
<dd><p id="dynamodb-stream-router-router-streamrouter-modify">Wrapper for StreamRouter.route(). Creates a route for “MODIFY” operation, taking an optional condition_expression</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>condition_expression:</em> (<code class="docutils literal notranslate"><span class="pre">Union[Callable,</span> <span class="pre">str]</span></code>): An expression that returns a boolean indicating if
the route should be called for a particular record. If type is <code class="docutils literal notranslate"><span class="pre">str</span></code> then the expression will be parsed using
<a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> <em>parse()</em> method to generate the callable</p></li>
<li><p><em>halt:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Stop processing of record after this route is called. The same effect can be acheived by returning
an object of type <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.Halt</span></code>. Default is False</p></li>
<li><p><em>priority:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The priority of this route in the list of any matching routes for a record. Default is 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;foo&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_foo</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.remove">
<code class="sig-name descname"><span class="pre">remove</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.remove" title="Permalink to this definition">¶</a></dt>
<dd><p id="dynamodb-stream-router-router-streamrouter-remove">Wrapper for StreamRouter.route(). Creates a route for “REMOVE” operation, taking an optional condition_expression</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>condition_expression:</em> (<code class="docutils literal notranslate"><span class="pre">Union[Callable,</span> <span class="pre">str]</span></code>): An expression that returns a boolean indicating if
the route should be called for a particular record. If type is <code class="docutils literal notranslate"><span class="pre">str</span></code> then the expression will be parsed using
<a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> <em>parse()</em> method to generate the callable</p></li>
<li><p><em>halt:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Stop processing of record after this route is called. The same effect can be acheived by returning
an object of type <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.Halt</span></code>. Default is False</p></li>
<li><p><em>priority:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The priority of this route in the list of any matching routes for a record. Default is 0</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;foo&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_foo</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.resolve_all">
<code class="sig-name descname"><span class="pre">resolve_all</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">records</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dict</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.Result" title="dynamodb_stream_router.router.Result"><span class="pre">dynamodb_stream_router.router.Result</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.resolve_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Iterates through each record in a batch and calls any matching resolvers on them, returning a
list containing <code class="docutils literal notranslate"><span class="pre">Result</span></code> objects for any routes that were called on the records. If a route is called
on a record, and the route was created with <code class="docutils literal notranslate"><span class="pre">halt=True</span></code> or the route returns <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.Halt()</span></code>
then no further routes will be called on that record. Processing of other records will continue as normal.</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>records:</em> (<code class="docutils literal notranslate"><span class="pre">List[dict]</span></code>): List of Dynamodb stream records to process. Normally you would pass <code class="docutils literal notranslate"><span class="pre">event[&quot;Records&quot;]</span></code></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#dynamodb-stream-router-router-result">dynamodb_stream_router.router.Result</a> ]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.resolve_record">
<code class="sig-name descname"><span class="pre">resolve_record</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#dynamodb_stream_router.router.StreamRecord" title="dynamodb_stream_router.router.StreamRecord"><span class="pre">dynamodb_stream_router.router.StreamRecord</span></a></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">List</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.Result" title="dynamodb_stream_router.router.Result"><span class="pre">dynamodb_stream_router.router.Result</span></a><span class="p"><span class="pre">]</span></span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.resolve_record" title="Permalink to this definition">¶</a></dt>
<dd><p>Resolves a single record, returning a list containing <code class="docutils literal notranslate"><span class="pre">Result</span></code> objects for any
routes that were called on the record</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>record:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): A single stream record</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List[<a class="reference internal" href="#dynamodb-stream-router-router-result">dynamodb_stream_router.router.Result</a> ]</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.route">
<code class="sig-name descname"><span class="pre">route</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">operations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span> </span><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_expression</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception_handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.ExceptionHandler" title="dynamodb_stream_router.router.ExceptionHandler"><span class="pre">dynamodb_stream_router.router.ExceptionHandler</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halt_on_exception</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.route" title="Permalink to this definition">¶</a></dt>
<dd><p id="dynamodb-stream-router-router-streamrouter-route">Used as a decorator to register a route. Accepts keyword arguments that determine under what conditions the route will
be called. If no condition_expression is provided then the route will be called for any operations that are
passed.</p>
<dl class="field-list simple">
<dt class="field-odd">Keyword Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>operations:</em> (<code class="docutils literal notranslate"><span class="pre">Union[str,</span> <span class="pre">List[str]</span></code>): A Dynamodb operation or list of operations. Can be one or
more of ‘REMOVE | INSERT | MODIFY’</p></li>
<li><p><em>condition_expression:</em> (<code class="docutils literal notranslate"><span class="pre">Union[Callable,</span> <span class="pre">str]</span></code>): An expression that returns a boolean indicating if
the route should be called for a particular record. If type is <code class="docutils literal notranslate"><span class="pre">str</span></code> then the expression will be parsed using
<a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> <em>parse()</em>  to generate the callable</p></li>
<li><p><em>halt:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): Stop processing of record after this route is called. The same effect can be acheived by returning
an object of type <code class="docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.Halt</span></code>. Default is False</p></li>
<li><p><em>priority:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>): The priority of this route in the list of any matching routes for a record. Default is 0</p></li>
<li><p><em>halt_on_exception:</em> (<code class="docutils literal notranslate"><span class="pre">bool</span></code>): If True and a route’s callable raises an exception then the exception will be propagated,
otherwise the exception will be caught and placed in Result.error</p></li>
<li><p><em>exception_handler:</em> (<code class="docutils literal notranslate"><span class="pre">ExceptionHandler</span></code> ): An instance of <a class="reference internal" href="#dynamodb-stream-router-router-exceptionhandler">dynamodb_stream_router.router.ExceptionHandler</a> that, if a
route’s callable raises an exception AND the exception is of one of the types in exception_handler.exceptions, will have
its handler called with the record and exception that was raised passed as arguments. Nothing is done with the return
value of the handler and if <cite>halt_on_exception</cite> is set then the original exception will still be propagated</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">route</span><span class="p">([</span><span class="s2">&quot;MODIFY&quot;</span><span class="p">,</span> <span class="s2">&quot;INSERT&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">],</span> <span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;foo&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_foo_any</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">route</span><span class="p">([</span><span class="s2">&quot;INSERT&quot;</span><span class="p">,</span> <span class="s2">&quot;DELETE&quot;</span><span class="p">],</span> <span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;bar&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_bar_new_and_delete</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">route</span><span class="p">([</span><span class="s2">&quot;INSERT&quot;</span><span class="p">],</span> <span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;has_changed(&#39;baz&#39;)&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">process_new_baz</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="k">pass</span>
</pre></div>
</div>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.StreamRouter.routes">
<code class="sig-name descname"><span class="pre">routes</span></code><em class="property"><span class="pre">:</span> <span class="pre">dynamodb_stream_router.router.RouteSet</span></em><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.routes" title="Permalink to this definition">¶</a></dt>
<dd><p>A list of dynamodb_stream_router.Route that are registered to the router</p>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.threaded">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">threaded</span></code><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.threaded" title="Permalink to this definition">¶</a></dt>
<dd><p>If True, then each record will be handled in its own thread using ThreadPoolExecutor</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.router.StreamRouter.threads">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">threads</span></code><a class="headerlink" href="#dynamodb_stream_router.router.StreamRouter.threads" title="Permalink to this definition">¶</a></dt>
<dd><p>Max number of threads to use in ThreadPoolExecutor.  If self.threaded = False
then setting this will also set self.threaded to True. If self.threaded = True,
then setting this to a non-zero value will set it to False</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">int</span></code></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="router-route">
<h2>router.Route<a class="headerlink" href="#router-route" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.router.Route">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.router.</span></code><code class="sig-name descname"><span class="pre">Route</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callable</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">operations</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dynamodb_stream_router.router.Operations</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">condition_expression</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priority</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">int</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halt</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">halt_on_exception</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">bool</span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exception_handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.ExceptionHandler" title="dynamodb_stream_router.router.ExceptionHandler"><span class="pre">dynamodb_stream_router.router.ExceptionHandler</span></a><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.router.Route" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p id="dynamodb-stream-router-router-route">A route object to be registered into an instance of <a class="reference internal" href="#dynamodb-stream-router-router-streamrouter">dynamodb_stream_router.router.StreamRouter</a>
See the following for usage:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrouter-insert">dynamodb_stream_router.router.StreamRouter.insert</a></p></li>
<li><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrouter-remove">dynamodb_stream_router.router.StreamRouter.remove</a></p></li>
<li><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrouter-modify">dynamodb_stream_router.router.StreamRouter.modify</a></p></li>
<li><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrouter-route">dynamodb_stream_router.router.StreamRouter.Route</a></p></li>
</ul>
</div></blockquote>
<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.callable">
<code class="sig-name descname"><span class="pre">callable</span></code><em class="property"><span class="pre">:</span> <span class="pre">Callable</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.callable" title="Permalink to this definition">¶</a></dt>
<dd><p>The Callable that will be triggered if this route is a match for a record</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.condition_expression">
<code class="sig-name descname"><span class="pre">condition_expression</span></code><em class="property"><span class="pre">:</span> <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Callable</span><span class="p"><span class="pre">,</span> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.condition_expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional <a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a> string or Callable to be used for route matching</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.exception_handler">
<code class="sig-name descname"><span class="pre">exception_handler</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#dynamodb_stream_router.router.ExceptionHandler" title="dynamodb_stream_router.router.ExceptionHandler"><span class="pre">dynamodb_stream_router.router.ExceptionHandler</span></a></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.exception_handler" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional callable that will be passed the record and exception that was raised in the case that the route’s callable raises an exception</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.halt">
<code class="sig-name descname"><span class="pre">halt</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.halt" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional flag to indicate record processing should stop after this route is called</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.halt_on_exception">
<code class="sig-name descname"><span class="pre">halt_on_exception</span></code><em class="property"><span class="pre">:</span> <span class="pre">bool</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.halt_on_exception" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional flat that indicates whether to halt all processing if a route raises an exception. If True then the exception will be raised, if False the exception will be placed in Result.error</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.operations">
<code class="sig-name descname"><span class="pre">operations</span></code><em class="property"><span class="pre">:</span> <span class="pre">List</span><span class="p"><span class="pre">[</span></span><span class="pre">dynamodb_stream_router.router.Operations</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.operations" title="Permalink to this definition">¶</a></dt>
<dd><p>The operations that this route is registered for (MODIFY | INSERT | DELETE)</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Route.priority">
<code class="sig-name descname"><span class="pre">priority</span></code><em class="property"><span class="pre">:</span> <span class="pre">int</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Route.priority" title="Permalink to this definition">¶</a></dt>
<dd><p>Optional Priority to assign to this route. All routes that match a record will be called in order of priority</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="router-exceptionhandler">
<h2>router.ExceptionHandler<a class="headerlink" href="#router-exceptionhandler" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.router.ExceptionHandler">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.router.</span></code><code class="sig-name descname"><span class="pre">ExceptionHandler</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handler</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.StreamRecord" title="dynamodb_stream_router.router.StreamRecord"><span class="pre">dynamodb_stream_router.router.StreamRecord</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Exception</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exceptions</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Exception</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.router.ExceptionHandler" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p id="dynamodb-stream-router-router-exceptionhandler">Provides a mechanism for attaching a callable to either the router or a specific route. When a route’s callable
raises an exception and the route or router has <cite>exception_handler</cite> set, then the handler will be passed the record
and exception that was raised by the route’s callable as arguments IF the exception is of a type in <cite>ExceptionHandler.exceptions</cite>.
Nothing is done with the return value of the handler</p>
<p>Example Usage:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_router</span> <span class="kn">import</span> <span class="n">StreamRouter</span><span class="p">,</span> <span class="n">ExceptionHandler</span>
<span class="kn">from</span> <span class="nn">logging</span> <span class="kn">import</span> <span class="n">getLogger</span>


<span class="k">def</span> <span class="nf">error_handler</span><span class="p">(</span><span class="n">record</span><span class="p">,</span> <span class="n">error</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">record</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">error</span><span class="p">)</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">StreamRouter</span><span class="p">()</span>
<span class="n">router</span><span class="o">.</span><span class="n">exception_handler</span> <span class="o">=</span> <span class="n">ExceptionHandler</span><span class="p">(</span>
    <span class="n">handler</span><span class="o">=</span><span class="n">error_handler</span><span class="p">,</span>
    <span class="n">exceptions</span><span class="o">=</span><span class="p">(</span><span class="ne">KeyError</span><span class="p">,</span> <span class="ne">ValueError</span><span class="p">)</span>
<span class="p">)</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">modify</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="s2">&quot;$OLD.foo == True&quot;</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">handle_foo</span><span class="p">(</span><span class="n">record</span><span class="p">):</span>
    <span class="c1"># Will trigger error_handler() to print the record and exception</span>
    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Caught an exception in handle_foo&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">handler</span><span class="p">(</span><span class="n">event</span><span class="p">,</span> <span class="n">ctx</span><span class="p">):</span>
    <span class="n">router</span><span class="o">.</span><span class="n">resolve_all</span><span class="p">(</span><span class="n">event</span><span class="p">[</span><span class="s2">&quot;Records&quot;</span><span class="p">])</span>
</pre></div>
</div>
<dl class="py attribute">
<dt id="dynamodb_stream_router.router.ExceptionHandler.exceptions">
<code class="sig-name descname"><span class="pre">exceptions</span></code><em class="property"><span class="pre">:</span> <span class="pre">Tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Exception</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamodb_stream_router.router.ExceptionHandler.exceptions" title="Permalink to this definition">¶</a></dt>
<dd><p>A tuple of exception types to catch</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.ExceptionHandler.handler">
<code class="sig-name descname"><span class="pre">handler</span></code><em class="property"><span class="pre">:</span> <span class="pre">Callable</span><span class="p"><span class="pre">[</span></span><span class="p"><span class="pre">[</span></span><a class="reference internal" href="#dynamodb_stream_router.router.StreamRecord" title="dynamodb_stream_router.router.StreamRecord"><span class="pre">dynamodb_stream_router.router.StreamRecord</span></a><span class="p"><span class="pre">,</span> </span><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Exception</span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamodb_stream_router.router.ExceptionHandler.handler" title="Permalink to this definition">¶</a></dt>
<dd><p>The callable that will be passed the original record and exception raised by the route callable that raised the exception</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="router-streamrecord">
<h2>router.StreamRecord<a class="headerlink" href="#router-streamrecord" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.router.StreamRecord">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.router.</span></code><code class="sig-name descname"><span class="pre">StreamRecord</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.router.StreamRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#dynamodb_stream_router.router.StreamRecord" title="dynamodb_stream_router.router.StreamRecord"><code class="xref py py-class docutils literal notranslate"><span class="pre">dynamodb_stream_router.router.StreamRecord</span></code></a></p>
<p id="dynamodb-stream-router-router-streamrecord">Creates a properly formatted record to be consumed by <a class="reference internal" href="#dynamodb-stream-router-router-streamrouter">dynamodb_stream_router.router.StreamRouter</a>
or <a class="reference internal" href="#dynamodb-stream-router-conditions-expression">dynamodb_stream_router.conditions.Expression</a></p>
<dl class="field-list simple">
<dt class="field-odd">Properties</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>eventName:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): MODIFY | INSERT | DELETE</p></li>
<li><p><em>StreamViewType:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): NEW_AND_OLD_IMAGES is the only one we support. Any other will cause an exception</p></li>
<li><p><em>awsRegion:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>eventID:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>eventSource:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>eventSourceARN:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>eventVersion:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>Keys:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)</p></li>
<li><p><em>NewImage:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)</p></li>
<li><p><em>OldImage:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>)</p></li>
<li><p><em>SequenceNumber:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>)</p></li>
<li><p><em>SizeBytes:</em> (<code class="docutils literal notranslate"><span class="pre">int</span></code>)</p></li>
<li><p><em>original:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>): The original, unserialized record</p></li>
</ul>
</dd>
<dt class="field-even">Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><em>record:</em> (<code class="docutils literal notranslate"><span class="pre">dict</span></code>):  A single record from a Dynamodb stream event</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrecord">dynamodb_stream_router.router.StreamRecord</a></p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="router-result">
<h2>router.Result<a class="headerlink" href="#router-result" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.router.Result">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.router.</span></code><code class="sig-name descname"><span class="pre">Result</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">route</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><a class="reference internal" href="#dynamodb_stream_router.router.Route" title="dynamodb_stream_router.router.Route"><span class="pre">dynamodb_stream_router.router.Route</span></a></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">dict</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Any</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">error</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dynamodb_stream_router.exceptions.HandledRouteException</span><span class="p"><span class="pre">,</span> </span><span class="pre">dynamodb_stream_router.exceptions.UnhandledRouteException</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.router.Result" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tuple</span></code></p>
<p id="dynamodb-stream-router-router-result">The result returned by a route called by <a class="reference internal" href="#dynamodb-stream-router-router-streamrouter">dynamodb_stream_router.router.StreamRouter</a></p>
<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Result.error">
<code class="sig-name descname"><span class="pre">error</span></code><em class="property"><span class="pre">:</span> <span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">dynamodb_stream_router.exceptions.HandledRouteException</span><span class="p"><span class="pre">,</span> </span><span class="pre">dynamodb_stream_router.exceptions.UnhandledRouteException</span><span class="p"><span class="pre">]</span></span></em><a class="headerlink" href="#dynamodb_stream_router.router.Result.error" title="Permalink to this definition">¶</a></dt>
<dd><p>Any errors that were raised during the route’s callable’s execution</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Result.record">
<code class="sig-name descname"><span class="pre">record</span></code><em class="property"><span class="pre">:</span> <span class="pre">dict</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Result.record" title="Permalink to this definition">¶</a></dt>
<dd><p>The original stream record passed to the Route’s callable</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Result.route">
<code class="sig-name descname"><span class="pre">route</span></code><em class="property"><span class="pre">:</span> <a class="reference internal" href="#dynamodb_stream_router.router.Route" title="dynamodb_stream_router.router.Route"><span class="pre">dynamodb_stream_router.router.Route</span></a></em><a class="headerlink" href="#dynamodb_stream_router.router.Result.route" title="Permalink to this definition">¶</a></dt>
<dd><p>The complete <a class="reference internal" href="#dynamodb-stream-router-router-route">dynamodb_stream_router.router.Route</a>  object that generated this result</p>
</dd></dl>

<dl class="py attribute">
<dt id="dynamodb_stream_router.router.Result.value">
<code class="sig-name descname"><span class="pre">value</span></code><em class="property"><span class="pre">:</span> <span class="pre">Any</span></em><a class="headerlink" href="#dynamodb_stream_router.router.Result.value" title="Permalink to this definition">¶</a></dt>
<dd><p>The return value of the callable for the Route that was called</p>
</dd></dl>

</dd></dl>

<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
</tbody>
</table>
</div>
</div>
<div class="section" id="dynamodb-stream-router-conditions-module">
<h1>dynamodb_stream_router.conditions module<a class="headerlink" href="#dynamodb-stream-router-conditions-module" title="Permalink to this headline">¶</a></h1>
<div class="section" id="conditions-parser-expression">
<h2>conditions.parser.Expression<a class="headerlink" href="#conditions-parser-expression" title="Permalink to this headline">¶</a></h2>
<dl class="py class">
<dt id="dynamodb_stream_router.conditions.parser.Expression">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">dynamodb_stream_router.conditions.parser.</span></code><code class="sig-name descname"><span class="pre">Expression</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">sly.yacc.Parser</span></code></p>
<p id="dynamodb-stream-router-conditions-expression">Used to build an expression from a string that, when passed to the evaluation method, will return a bool
by executing the statements in the expression against a <a class="reference internal" href="#dynamodb-stream-router-router-streamrecord">dynamodb_stream_router.router.StreamRecord</a>.
Example of testing an expression directly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">dynamodb_stream_parser.conditions.parser</span> <span class="kn">import</span> <span class="n">Expression</span>
<span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span><span class="p">,</span> <span class="n">Record</span>


<span class="n">router</span> <span class="o">=</span> <span class="n">StreamRouter</span><span class="p">(</span><span class="n">threaded</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">item</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s2">&quot;StreamViewType&quot;</span><span class="p">:</span> <span class="s2">&quot;NEW_AND_OLD_IMAGES&quot;</span><span class="p">,</span>
    <span class="s2">&quot;eventName&quot;</span><span class="p">:</span> <span class="s2">&quot;MODIFY&quot;</span><span class="p">,</span>
    <span class="s2">&quot;dynamodb&quot;</span><span class="p">:</span> <span class="p">{</span>
        <span class="s2">&quot;OldImage&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span>
                <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span>
                    <span class="s2">&quot;foo&quot;</span><span class="p">:</span> <span class="p">{</span>
                        <span class="s2">&quot;M&quot;</span><span class="p">:</span> <span class="p">{</span>
                            <span class="s2">&quot;bar&quot;</span><span class="p">:</span> <span class="p">{</span>
                                <span class="s2">&quot;L&quot;</span><span class="p">:</span> <span class="p">[</span>
                                    <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;baz&quot;</span><span class="p">}</span>
                                <span class="p">]</span>
                            <span class="p">}</span>
                        <span class="p">}</span>
                    <span class="p">}</span>
                <span class="p">}</span>
            <span class="p">}</span>
        <span class="p">},</span>
        <span class="s2">&quot;NewImage&quot;</span><span class="p">:</span> <span class="p">{</span>
            <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="s2">&quot;sometype&quot;</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">}</span>
<span class="p">}</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">Expression</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="s2">&quot;$NEW.type == &#39;sometype&#39; &amp; has_changed(&#39;type&#39;)&quot;</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">exp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">record</span><span class="o">=</span><span class="n">Record</span><span class="p">(</span><span class="n">item</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">exp</span><span class="o">.</span><span class="n">evaluate</span><span class="p">())</span>
<span class="c1"># Prints &#39;True&#39;</span>


<span class="sd">&#39;&#39;&#39; Using an expression with StreamRouter &#39;&#39;&#39;</span>
<span class="kn">from</span> <span class="nn">dynamodb_stream_parser.conditions.parser</span> <span class="kn">import</span> <span class="n">Expression</span>
<span class="kn">from</span> <span class="nn">dynamodb_stream_router.router</span> <span class="kn">import</span> <span class="n">StreamRouter</span><span class="p">,</span> <span class="n">Record</span>

<span class="n">router</span> <span class="o">=</span> <span class="n">StreamRouter</span><span class="p">()</span>
<span class="n">exp</span> <span class="o">=</span> <span class="s2">&quot;$NEW.type == &#39;sometype&#39; &amp; has_changed(&#39;type&#39;)</span>


<span class="nd">@router</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">condition_expression</span><span class="o">=</span><span class="n">exp</span><span class="p">)</span>
<span class="k">def</span> <span class="nf">func_name</span><span class="p">(</span><span class="n">item</span><span class="p">):</span>
    <span class="k">return</span> <span class="mi">1</span>


<span class="n">records</span> <span class="o">=</span> <span class="p">[</span><span class="n">StreamRecord</span><span class="p">(</span><span class="n">item</span><span class="p">)]</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">router</span><span class="o">.</span><span class="n">resolve_all</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
<span class="nb">print</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">res</span><span class="p">])</span>

<span class="c1"># prints &#39;[1]&#39;</span>
</pre></div>
</div>
<p>More about using <a class="reference internal" href="#dynamodb-stream-router-router-streamrouter">dynamodb_stream_router.router.StreamRouter</a></p>
<table class="colwidths-given docutils align-default" id="id1">
<caption><span class="caption-text">Identifiers</span><a class="headerlink" href="#id1" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 42%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Example</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>VALUE</p></td>
<td><p>A quoted string (single or double), integer, or float representing a literal value</p></td>
<td><p>‘foo’</p></td>
</tr>
<tr class="row-odd"><td><p>$OLD</p></td>
<td><p>A reference to StreamRecord.OldImage</p></td>
<td><p>$OLD.foo</p></td>
</tr>
<tr class="row-even"><td><p>$NEW</p></td>
<td><p>A reference to StreamRecord.NewImage</p></td>
<td><p>$NEW.bar</p></td>
</tr>
<tr class="row-odd"><td><p>PATH</p></td>
<td><p>A path inside of a StreamRecord. Paths always start with $OLD or $NEW</p></td>
<td><p>$OLD.foo.bar or $OLD[“foo”][“bar”] or $NEW.foo[0]</p></td>
</tr>
<tr class="row-even"><td><p>INDEX</p></td>
<td><p>A numeric index into a PATH where PATH is a List</p></td>
<td><p>$OLD.foo[0]</p></td>
</tr>
<tr class="row-odd"><td><p>Key</p></td>
<td><p>A python-style key reference within a PATH</p></td>
<td><p>$OLD[“foo”]</p></td>
</tr>
</tbody>
</table>
<table class="colwidths-given docutils align-default" id="id2">
<caption><span class="caption-text">Operators</span><a class="headerlink" href="#id2" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 29%" />
<col style="width: 71%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Operator</p></th>
<th class="head"><p>Action</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>&amp;</p></td>
<td><p>Logical AND</p></td>
</tr>
<tr class="row-odd"><td><p>|</p></td>
<td><p>Logical OR</p></td>
</tr>
<tr class="row-even"><td><p>()</p></td>
<td><p>Grouping of expressions</p></td>
</tr>
<tr class="row-odd"><td><p>==</p></td>
<td><p>Equality</p></td>
</tr>
<tr class="row-even"><td><p>!=</p></td>
<td><p>Non equality</p></td>
</tr>
<tr class="row-odd"><td><p>&gt;</p></td>
<td><p>Greater than</p></td>
</tr>
<tr class="row-even"><td><p>&gt;=</p></td>
<td><p>Greater than or equal to</p></td>
</tr>
<tr class="row-odd"><td><p>&lt;</p></td>
<td><p>Less than</p></td>
</tr>
<tr class="row-even"><td><p>&lt;=</p></td>
<td><p>Less than or equal to</p></td>
</tr>
<tr class="row-odd"><td><p>=~</p></td>
<td><p>Regex comparison &lt;value&gt; =~ &lt;regex&gt;</p></td>
</tr>
</tbody>
</table>
<p>Comparison operators, except for regex comparison, can compare PATH to VALUE, PATH to PATH, or even VALUE to VALUE.</p>
<table class="colwidths-given docutils align-default" id="id3">
<caption><span class="caption-text">Functions</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 22%" />
<col style="width: 22%" />
<col style="width: 56%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Name</p></th>
<th class="head"><p>Arguments</p></th>
<th class="head"><p>Description</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>has_changed(VALUE, VALUE)</p></td>
<td><p>Comma-separated list of quoted values</p></td>
<td><p>Tests each value to see if that key in the top level of $OLD differs from $NEW. Returns True if any of the elements have changed</p></td>
</tr>
<tr class="row-odd"><td><p>is_type(PATH, TYPE)</p></td>
<td><p>PATH - The path to a value to test and the Dynamodb type to test for, TYPE - Any Dynamodb Type</p></td>
<td><p>Returns if PATH is of type TYPE. TYPE can be any unquoted Dynamodb type (S, SS, B, BS, N, NS, M, BOOL, L)</p></td>
</tr>
<tr class="row-even"><td><p>attribute_exists(PATH)</p></td>
<td><p>PATH - An element to test the existence of</p></td>
<td><p>Returns a bool indicating if the specified key/index exists in PATH</p></td>
</tr>
<tr class="row-odd"><td><p>from_json(PATH)</p></td>
<td><p>PATH - A path to decode</p></td>
<td><p>Returns a value returned from simplejson.loads()</p></td>
</tr>
</tbody>
</table>
<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.evaluate">
<code class="sig-name descname"><span class="pre">evaluate</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">record</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">Optional</span><span class="p"><span class="pre">[</span></span><span class="pre">object</span><span class="p"><span class="pre">]</span></span></span> <span class="o"><span class="pre">=</span></span> <span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">bool</span><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluates an expression against a StreamRecord, returning the resulting bool</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>expression:</em> (<code class="docutils literal notranslate"><span class="pre">str</span></code>): The expression to evaluate</p></li>
</ul>
</dd>
<dt class="field-even">Keyword Arguments</dt>
<dd class="field-even"><ul class="simple">
<li><p><em>record:</em> (<a class="reference internal" href="#dynamodb-stream-router-router-streamrecord">dynamodb_stream_router.router.StreamRecord</a>): The record to evaluate against. If not provided then self.record will be used. If self.record is None TypeError will be raised</p></li>
</ul>
</dd>
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">bool</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.new">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">new</span></code><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.new" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">self.record.NewImage</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.new_keys">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">new_keys</span></code><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.new_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">list(self.record.NewImage.keys())</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.old">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">old</span></code><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.old" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">self.record.OldImage</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">dict</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.old_keys">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">old_keys</span></code><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.old_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Shorthand for <code class="docutils literal notranslate"><span class="pre">list(self.record.OldImage.keys())</span></code></p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><code class="docutils literal notranslate"><span class="pre">list</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.parse">
<code class="sig-name descname"><span class="pre">parse</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">expression</span></span><span class="p"><span class="pre">:</span></span> <span class="n"><span class="pre">str</span></span></em><span class="sig-paren">)</span> &#x2192; <span class="pre">Callable</span><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.parse" title="Permalink to this definition">¶</a></dt>
<dd><p id="dynamodb-stream-router-conditions-parser-expression-parse">Takes an expression string and returns a function, which can evaluate against a record</p>
<dl class="field-list simple">
<dt class="field-odd">Arguments</dt>
<dd class="field-odd"><ul class="simple">
<li><p><em>expression</em>: (<code class="docutils literal notranslate"><span class="pre">str</span></code>): An expressions as a string to parse</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><code class="docutils literal notranslate"><span class="pre">Callable</span></code></p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="dynamodb_stream_router.conditions.parser.Expression.record">
<em class="property"><span class="pre">property</span> </em><code class="sig-name descname"><span class="pre">record</span></code><a class="headerlink" href="#dynamodb_stream_router.conditions.parser.Expression.record" title="Permalink to this definition">¶</a></dt>
<dd><p>The StreamRecord to evaluate against</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><a class="reference internal" href="#dynamodb-stream-router-router-streamrecord">dynamodb_stream_router.router.StreamRecord</a></p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Mathew Moon &lt;mmoon@quinovas.com&gt;.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>